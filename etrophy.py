import numpy as np, math

def H_bits(pcts):
    print(" Sum:", sum(pcts))
    p = np.array(pcts, float); p /= p.sum()
    return float(-(p * np.log2(p + 1e-12)).sum())

# 示例：把每个 4-bit 模式的百分比填进来（单位：%）
wo_tde = [0.5117505854659791, 0.002071656333137078, 0.005089101018412571, 0.0, 0.0, 0.03774041728749298, 0.009199409011134224, 0.0013822903574409217, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.43435510287747586]
w_tde  = [0.2632128477569288, 0.05781026375386361, 0.01549699234609072, 0.0654111158035265, 0.01956101022210193, 0.007734672469147257, 0.017631714152418907, 0.05547623710587911, 0.043020382297095025, 0.008157928620826958, 0.003665264719002511, 0.012225968186290419, 0.05556442970037241, 0.019572052901381053, 0.05870966388927424, 0.2971465966635687]

H_wo = H_bits(wo_tde); H_w = H_bits(w_tde)
print("H w/o TDE  (bits/4-step):", H_wo, " -> per step:", H_wo/4)
print("H with TDE (bits/4-step):", H_w,  " -> per step:", H_w/4)
